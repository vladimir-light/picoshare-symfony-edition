<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{{ APP_NAME }} &ndash; {% block page_title '' %}{% endblock title %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css">
    {% block stylesheets '' %}
    {% block javascripts '' %}

    {% block on_page_style_tag %}
        <style>
            :root{}
            body {
                display: flex;
                flex-direction: column;
                min-height: 100vh;
            }

            /* Main content area grows to fill available space */
            .main-content {
                flex: 1;
            }

            .flash-messages:empty {
                display: none !important;
            }
        </style>
    {% endblock on_page_style_tag %}
</head>
{% block body %}
    <body>
    {% block body_contents %}
        {% block body_main_nav %}
            {% include '_partials/main_nav.html.twig' with { show_theme_toggle: false } only %}
        {% endblock body_main_nav %}
        <main class="main-content">
            {% block flash_messahes %}
                <!-- Flash-Messages -->
                {% include '_partials/flash_messages.html.twig' with {} only %}
            {% endblock flash_messahes %}
            {% block body_main_sections %}
                <section class="section">
                    <div class="container">
                        Lorem Ipsum...
                    </div>
                </section>
            {% endblock body_main_sections %}
        </main>
        {% block body_main_footer %}
            {% include '_partials/main_footer.html.twig' with {} only %}
        {% endblock body_main_footer %}
    {% endblock body_contents %}
    {% block page_end_javascript %}
        <!-- JavaScript for navbar burger and theme toggle -->
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                // Navbar burger toggle
                const burgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
                burgers.forEach(burger => {
                    burger.addEventListener('click', () => {
                        const target = burger.dataset.target;
                        const menu = document.getElementById(target);
                        burger.classList.toggle('is-active');
                        menu.classList.toggle('is-active');
                    });
                });
            });
            // copy-to-clipboard handler for all "copy" buttons
            if( navigator.clipboard && window.isSecureContext )
            {
                document.querySelectorAll('button[data-clipboard-text]:not([aria-busy="true"]:enabled)').forEach(copyBtn => {
                    copyBtn.addEventListener('click', async (ev) => {
                        let success = false;
                        const copyBtnEl = ev.currentTarget;
                        const content = copyBtnEl.dataset.clipboardText;
                        const oldContents =  ev.currentTarget.innerHTML;
                        try {
                            await navigator.clipboard.writeText(content);
                            success = true;
                            // TODO: snackbar notification -> https://www.w3schools.com/howto/howto_js_snackbar.asp
                            copyBtnEl.ariaBusy = true;
                            copyBtnEl.innerHTML = '<i class="fa-regular fa-circle-check"></i>';
                        } catch (err) {
                            console.error(err);
                        } finally {
                            setTimeout(() => {
                                copyBtnEl.ariaBusy = false;
                                copyBtnEl.innerHTML = oldContents;
                            }, success ? 500: 1500 );
                        }
                    });
                });
            }
            else
            {
                console.warm('Clipboard API disabled!');
            }

            // a bit uploaded file magic
            const fileInput = document.querySelector("form[enctype] input[type=file]");
            if( fileInput )
            {
                fileInput.onchange = () => {
                    if (fileInput.files.length > 0) {
                        const fileName = document.querySelector(".file-label .file-name");
                        fileName.textContent = fileInput.files[0].name;
                        fileName.setAttribute('title', fileInput.files[0].name)
                    }
                };
            }

        </script>
    {% endblock page_end_javascript %}
    </body>
{% endblock body %}
</html>
